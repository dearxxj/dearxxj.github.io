<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Similarity measurement of two sets of TADs - Fan&#39;s Blog</title>
  <meta name="description" content="Months ago I had this question of comparing TADs from two Hi-C experiments in my research. TAD is short for topologically associated domains, discovered by Dixon et al [1] in 2012, which are regions in the genome that interacts more frequenctly with regions in the domain than outside. The goal of comparing TADs from two Hi-C expriments is to search for differentially interacting regions under two conditions to tease out regions that react to the conditions.">
  <meta name="author" content="Fan"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Fan\x27s Blog",
    
    "url": "https:\/\/dearxxj.github.io"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/dearxxj.github.io"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/dearxxj.github.io",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/dearxxj.github.io\/post\/3\/",
          "name": "Similarity measurement of two sets of t a ds"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Fan"
  },
  "headline": "Similarity measurement of two sets of TADs",
  "description" : "Months ago I had this question of comparing TADs from two Hi-C experiments in my research. TAD is short for topologically associated domains, discovered by Dixon et al [1] in 2012, which are regions in the genome that interacts more frequenctly with regions in the domain than outside. The goal of comparing TADs from two Hi-C expriments is to search for differentially interacting regions under two conditions to tease out regions that react to the conditions.",
  "inLanguage" : "en",
  "wordCount":  931 ,
  "datePublished" : "2018-11-24T22:26:32",
  "dateModified" : "2018-11-24T22:26:32",
  "image" : "https:\/\/dearxxj.github.io\/img\/blog-log.png",
  "keywords" : [ "Statistics, Hi-C" ],
  "mainEntityOfPage" : "https:\/\/dearxxj.github.io\/post\/3\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/dearxxj.github.io",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/dearxxj.github.io\/img\/blog-log.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Similarity measurement of two sets of TADs" />
<meta property="og:description" content="Months ago I had this question of comparing TADs from two Hi-C experiments in my research. TAD is short for topologically associated domains, discovered by Dixon et al [1] in 2012, which are regions in the genome that interacts more frequenctly with regions in the domain than outside. The goal of comparing TADs from two Hi-C expriments is to search for differentially interacting regions under two conditions to tease out regions that react to the conditions.">
<meta property="og:image" content="https://dearxxj.github.io/img/blog-log.png" />
<meta property="og:url" content="https://dearxxj.github.io/post/3/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Fan&#39;s Blog" />

  <meta name="twitter:title" content="Similarity measurement of two sets of TADs" />
  <meta name="twitter:description" content="Months ago I had this question of comparing TADs from two Hi-C experiments in my research. TAD is short for topologically associated domains, discovered by Dixon et al [1] in 2012, which are regions â€¦">
  <meta name="twitter:image" content="https://dearxxj.github.io/img/blog-log.png" />
  <meta name="twitter:card" content="summary" />
  <link href='https://dearxxj.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.59.1" />
  <link rel="alternate" href="https://dearxxj.github.io/index.xml" type="application/rss+xml" title="Fan&#39;s Blog"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://dearxxj.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://dearxxj.github.io/css/highlight.min.css" /><link rel="stylesheet" href="https://dearxxj.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-104430016-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://dearxxj.github.io">Fan&#39;s Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Fan&#39;s Blog" href="https://dearxxj.github.io">
            <img class="avatar-img" src="https://dearxxj.github.io/img/blog-log.png" alt="Fan&#39;s Blog" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Similarity measurement of two sets of TADs</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on November 24, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;5&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;931&nbsp;words
  
  
    
      &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Fan
    
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>Months ago I had this question of comparing TADs from two Hi-C experiments in my research. TAD is short for topologically associated domains, discovered by <em>Dixon et al [1]</em> in 2012, which are regions in the genome that interacts more frequenctly with regions in the domain than outside. The goal of comparing TADs from two Hi-C expriments is to search for differentially interacting regions under two conditions to tease out regions that <em>react</em> to the conditions.</p>

<p>When I first thought about this question, I felt that <em>comparing TADs</em> is not well-defined. Let&rsquo;s put aside the specific differentially-interacting regions. Sometimes we might be interesting to know the overall similarity of two sets of TADs from two conditions. For example, TADs called from two biological replicates should have a high similarity. I have no clue on how to measure the similarity of two sets of TADs until I came across this paper[2] the other day. In this paper, Yu et al. introduced two metrics, <strong>Variation of Information</strong> (<strong>VI</strong>) and <strong>Jaccard Index</strong>, to do this.</p>

<p>A set of TADs are composed of continous or discrete genomic regions like below:</p>

<blockquote>
<p><em>chr1 40000 160000</em></p>

<p><em>chr1 22000000 24320000</em></p>

<p><em>&hellip;</em></p>

<p><em>chrX 5800000 7600000</em></p>
</blockquote>

<p>The Variation of Information proposed by <em>Marina Meila</em>[3] measures the similarity of two disjoint partitions of a given set. A disjoint partition of a set has the property that any two subsets have no common elements. Let&rsquo;s assume {<em>C1</em>, <em>C2</em>, &hellip;, <em>Ck</em>} is a disjoint partition of set <em>C</em>. If we randomly pick an element from <em>C</em>, the probability that it belongs to <em>Ck</em> is:</p>

<p><img src="/img/3.Fig1.png" alt="Figure 1" /></p>

<p>The overall uncertainty of the partition is equal to the <em>entropy</em> of the probability distribution.</p>

<p><img src="/img/3.Fig2.png" alt="Figure 2" /></p>

<p>Now if we have a second partition <em>C&rsquo;</em> of <em>C</em>, {<em>C&rsquo;1</em>, <em>C&rsquo;2</em>, &hellip;, <em>C&rsquo;k</em>}. We can define the mutual information between them as below.</p>

<p><img src="/img/3.Fig3.png" alt="Figure 3" /></p>

<p>Here is a nice explanation of above equation from <em>Marina Meila</em>:</p>

<blockquote>
<p>Intuitively, we can think of <em>I(C, C&rsquo;)</em> in the following way: we are given a random point in D. The uncertainty about its cluster in <em>C&rsquo;</em> is measured by H(<em>C&rsquo;</em>). Suppose now that we are told which cluster the point belongs to in <em>C</em>. How much does this knowledge reduce the uncertainty abuot <em>C&rsquo;</em>? This reduction in uncertainty, averaged over all points, is equal to <em>I(C, C&rsquo;)</em>.</p>
</blockquote>

<p>Then the <strong>VI</strong> is defined as follows.</p>

<p><img src="/img/3.Fig4.png" alt="Figure 4" /></p>

<p>Below is a simplified and faster way to calculate VI suggested by <em>Yu et al[2]</em>.</p>

<p><img src="/img/3.Fig5.png" alt="Figure 5" /></p>

<p>Note that <strong>VI</strong> is <strong>non-negative</strong> and has <strong>an upper bound</strong> of <em>log(n)</em> where n is the number of elements in <em>C</em>. Because <strong>VI</strong> only applies to disjoint partition of a set, while TAD can be hierarchical and nested (subTADs) in nature, <strong>VI</strong> is not suitable for subTADs. Jaccard Index has no such limitations and can be used for two sets of subTADs. Jaccard Index can be simply thought as the intersection over union. It is widely used to evaluate the similarity of two clusterings.</p>

<p>In practice, each TAD consists of multiple 40kb bins (or any resolution specified when TAD is called). I treated each bin as an element of a TAD set, then a TAD set of a given genome can be looked as a partition of genome-wide 40kb bins. Below I show an example of calculating VI and Jaccard Index.</p>

<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="ln"> 1</span><span class="k">def</span> <span class="nf">readTAD</span><span class="p">(</span><span class="nb">file</span><span class="p">):</span>
<span class="ln"> 2</span>    <span class="n">tad_set</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ln"> 3</span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="ln"> 4</span>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
<span class="ln"> 5</span>            <span class="n">tmp_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="ln"> 6</span>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="ln"> 7</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">40000</span><span class="p">):</span>
<span class="ln"> 8</span>                <span class="n">tmp_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="ln"> 9</span>            <span class="n">tad_set</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_set</span><span class="p">)</span>
<span class="ln">10</span>    <span class="k">return</span> <span class="n">tad_set</span>
<span class="ln">11</span>
<span class="ln">12</span><span class="c1"># Important sanity check step to make sure two TAD sets consisting of the same set of 40kb bins.</span>
<span class="ln">13</span><span class="k">def</span> <span class="nf">commonBins</span><span class="p">(</span><span class="n">tad1</span><span class="p">,</span> <span class="n">tad2</span><span class="p">):</span>
<span class="ln">14</span>    <span class="n">s1</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="n">tad1</span><span class="p">)</span>
<span class="ln">15</span>    <span class="n">s2</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span> <span class="n">tad2</span><span class="p">)</span>
<span class="ln">16</span>    <span class="n">s1_2</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="ln">17</span>    <span class="n">s1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ln">18</span>    <span class="n">s2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ln">19</span>    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">tad1</span><span class="p">:</span>
<span class="ln">20</span>        <span class="n">s_tmp</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s1_2</span><span class="p">)</span>
<span class="ln">21</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_tmp</span><span class="p">):</span>
<span class="ln">22</span>            <span class="n">s1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_tmp</span><span class="p">)</span>
<span class="ln">23</span>    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">tad2</span><span class="p">:</span>
<span class="ln">24</span>        <span class="n">s_tmp</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s1_2</span><span class="p">)</span>
<span class="ln">25</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_tmp</span><span class="p">):</span>
<span class="ln">26</span>            <span class="n">s2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s_tmp</span><span class="p">)</span>
<span class="ln">27</span>    <span class="k">return</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> 
<span class="ln">28</span>
<span class="ln">29</span><span class="k">def</span> <span class="nf">VIforTADs</span><span class="p">(</span><span class="n">tad1</span><span class="p">,</span> <span class="n">tad2</span><span class="p">):</span>
<span class="ln">30</span>    <span class="c1">## simplified version of calculation: VI = -sigma P(k, k&#39;)*log{ P(k, k&#39;)**2/( P(k)P(k&#39;) ) }</span>
<span class="ln">31</span>    <span class="c1">## P(k) = nk/n</span>
<span class="ln">32</span>    <span class="c1">## P(k, k&#39;) = |intersect(Ck, C&#39;k&#39;)| / n</span>
<span class="ln">33</span>    <span class="n">n1</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">),</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tad1</span><span class="p">])</span>
<span class="ln">34</span>    <span class="n">n2</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">),</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tad2</span><span class="p">])</span>
<span class="ln">35</span>    <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
<span class="ln">36</span>    <span class="n">VI</span> <span class="o">=</span> <span class="mi">0</span>
<span class="ln">37</span>    <span class="k">for</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">tad1</span><span class="p">:</span>
<span class="ln">38</span>        <span class="k">for</span> <span class="n">s2</span> <span class="ow">in</span> <span class="n">tad2</span><span class="p">:</span>
<span class="ln">39</span>            <span class="n">Pkk</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s2</span><span class="p">)))</span><span class="o">/</span><span class="n">n</span>
<span class="ln">40</span>            <span class="k">if</span> <span class="n">Pkk</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="ln">41</span>                <span class="n">VI</span> <span class="o">+=</span> <span class="o">-</span><span class="n">Pkk</span> <span class="o">*</span> <span class="n">log10</span><span class="p">(</span> <span class="p">(</span><span class="n">Pkk</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<span class="ln">42</span>    <span class="k">print</span> <span class="n">VI</span><span class="p">,</span> <span class="n">log10</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1">## VI &lt;= log(n)</span>
<span class="ln">43</span>    <span class="k">return</span> <span class="n">VI</span>
<span class="ln">44</span>
<span class="ln">45</span><span class="k">def</span> <span class="nf">JIforTADs</span><span class="p">(</span><span class="n">tad1</span><span class="p">,</span> <span class="n">tad2</span><span class="p">):</span>
<span class="ln">46</span>    <span class="n">maxJI</span> <span class="o">=</span> <span class="mi">0</span>
<span class="ln">47</span>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tad1</span><span class="p">)</span>
<span class="ln">48</span>    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tad2</span><span class="p">)</span>
<span class="ln">49</span>    <span class="n">ji</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
<span class="ln">50</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="ln">51</span>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
<span class="ln">52</span>            <span class="n">ji</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tad1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">tad2</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tad1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">tad2</span><span class="p">[</span><span class="n">j</span><span class="p">])))</span>
<span class="ln">53</span>    <span class="n">row_max_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ji</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># find the TAD in B that has the maximum JI with a TAD in A</span>
<span class="ln">54</span>    <span class="n">col_max_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ji</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># find the TAD in A that has the maximum JI with a TAD in B</span>
<span class="ln">55</span>    <span class="k">return</span> <span class="p">(</span><span class="n">row_max_sum</span> <span class="o">+</span> <span class="n">col_max_sum</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="n">n</span><span class="p">)</span>
<span class="ln">56</span>
<span class="ln">57</span><span class="n">tad1</span> <span class="o">=</span> <span class="n">readTAD</span><span class="p">(</span><span class="s1">&#39;exp_1.40kb.iced.domains&#39;</span><span class="p">)</span>
<span class="ln">58</span><span class="n">tad2</span> <span class="o">=</span> <span class="n">readTAD</span><span class="p">(</span><span class="s1">&#39;exp_2.40kb.iced.domains&#39;</span><span class="p">)</span>
<span class="ln">59</span><span class="n">tad1</span><span class="p">,</span> <span class="n">tad2</span> <span class="o">=</span> <span class="n">commonBins</span><span class="p">(</span><span class="n">tad1</span><span class="p">,</span> <span class="n">tad2</span><span class="p">)</span>
<span class="ln">60</span>
<span class="ln">61</span><span class="n">VIforTADs</span><span class="p">(</span><span class="n">tad1</span><span class="p">,</span> <span class="n">tad2</span><span class="p">)</span>
<span class="ln">62</span><span class="c1"># 0.0649948733336 4.81281980622</span>
<span class="ln">63</span>
<span class="ln">64</span><span class="n">JIforTADs</span><span class="p">(</span><span class="n">tad1</span><span class="p">,</span> <span class="n">tad2</span><span class="p">)</span>
<span class="ln">65</span><span class="c1"># 0.8993629455535996</span></code></pre></div>

<p>Reference:</p>

<p><em>[1]. Dixon et al. (2012). Topological domains in mammalian genomes identified by analysis of chromatin interactions. Nature.</em></p>

<p><em>[2]. Yu et al. (2018). Identifying topologically associating domains and subdomains by Gaussian Mixture model And Proportion Test. Nature Communications.</em></p>

<p><em>[3]. Meila, Marina. (2007). Comparing clusterings - an information based distance. Journal of Multivariate Analysis.</em></p>


        
          <div class="blog-tags">
            
              <a href="https://dearxxj.github.io/tags/statistics/">Statistics</a>&nbsp;
            
              <a href="https://dearxxj.github.io/tags/hi-c/">Hi-C</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=https%3a%2f%2fdearxxj.github.io%2fpost%2f3%2f&amp;text=Similarity%20measurement%20of%20two%20sets%20of%20TADs&amp;via=" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fdearxxj.github.io%2fpost%2f3%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=https%3a%2f%2fdearxxj.github.io%2fpost%2f3%2f&amp;title=Similarity%20measurement%20of%20two%20sets%20of%20TADs" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fdearxxj.github.io%2fpost%2f3%2f&amp;title=Similarity%20measurement%20of%20two%20sets%20of%20TADs" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fdearxxj.github.io%2fpost%2f3%2f&amp;title=Similarity%20measurement%20of%20two%20sets%20of%20TADs" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fdearxxj.github.io%2fpost%2f3%2f&amp;description=Similarity%20measurement%20of%20two%20sets%20of%20TADs" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  

              </div>
            </section>
        

        
          
            
          

          
                  <h4 class="see-also">See also</h4>
                  <ul>
                
                
                    <li><a href="/post/6/">Demystify Hi-C Data Normalization</a></li>
                
              </ul>

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://dearxxj.github.io/post/2/" data-toggle="tooltip" data-placement="top" title="How does number of threads affect mapping time in BWA MEM">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://dearxxj.github.io/post/4/" data-toggle="tooltip" data-placement="top" title="Exact string matching algorithms: Boyer-Moore and KMP">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
          
          <div class="disqus-comments">
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "fsong" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>
          
        
        
      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://github.com/dearxxj" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://dearxxj.github.io">Fan</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2019
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://dearxxj.github.io">Fan&#39;s Blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.59.1</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://dearxxj.github.io/js/main.js"></script>
<script src="https://dearxxj.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://dearxxj.github.io/js/load-photoswipe.js"></script>









    
  </body>
</html>

